<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Metronome Widget</title>
  <link rel="stylesheet" href="style.css?v=9"/>
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>
  <!-- Load Speed Mode and Random Mode first -->
  <script defer src="speed_mode.js?v=7"></script>
  <script defer src="random_mode.js?v=7"></script>
  <script defer src="script.js?v=11"></script>
</head>
<body>
  <!-- Metronome Container -->
  <div class="bpm_container">
    
    <!-- Top Bar Icons -->
    <div class="top-bar">
      <div id="speedIcon" class="icon-button" data-mode="speed" data-state="off">
        <i data-lucide="zap"></i>
      </div>
      <div class="timer-display">00:00;00</div>
      <div id="settingsIcon" class="icon-button">
        <i data-lucide="settings"></i>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- BPM Controls -->
      <div class="bpm-section">
        <button id="minusBtn" class="bpm-control" aria-label="Decrease BPM">
          <i data-lucide="minus"></i>
        </button>
        <div id="bpmDisplay" class="bpm-display">100</div>
        <button id="plusBtn" class="bpm-control" aria-label="Increase BPM">
          <i data-lucide="plus"></i>
        </button>
      </div>

      <!-- Play Button -->
      <div class="play-container">
        <svg class="progress-ring" viewBox="0 0 120 120">
          <circle class="progress-ring-bg" cx="60" cy="60" r="54" />
          <circle class="progress-ring-bar" cx="60" cy="60" r="54" />
        </svg>
        <button id="playPauseBtn" class="play-button" aria-label="Play/Pause">
          <i data-lucide="play"></i>
        </button>
      </div>

      <!-- Reset Icon (hidden by default) -->
      <button id="resetIcon" class="reset-button" style="display: none;" aria-label="Reset timer">
        <i data-lucide="rotate-ccw"></i>
      </button>
    </div>
  </div>

  <!-- Speed Mode Popup -->
  <div id="speedModePopup" class="speed-mode-popup" style="display: none;">
    <div class="popup-content">
      <span id="closePopup" class="close-popup">&times;</span>
      <h2>Speed Mode Settings</h2>
      <div class="input-row">
        <label for="initialBpm">Initial BPM:</label>
        <input type="number" id="initialBpm" value="100">
      </div>
      <div class="input-row">
        <label for="finalBpm">Final BPM:</label>
        <input type="number" id="finalBpm" value="180">
      </div>
      <div class="input-row">
        <label for="increment">Raise BPM:</label>
        <input type="number" id="increment" value="5">
      </div>
      <div class="input-row">
        <label for="bars">Bars:</label>
        <input type="number" id="bars" value="16">
      </div>
      <button id="saveSpeedMode">Save</button>
      <div id="estimatedTime" style="color: #ffffff; margin-top: 30px;">Estimated time: 0 min</div>
    </div>
  </div>

  <!-- Random Mode Popup (styled like Speed Mode Popup) -->
  <div id="randomModePopup" class="speed-mode-popup" style="display: none;">
    <div class="popup-content">
      <span id="closeRandomPopup" class="close-popup">&times;</span>
      <h2>Random Silent Mode Settings</h2>
      <div class="input-row">
        <label for="randomPercent">Random %:</label>
        <input type="number" id="randomPercent" value="50" />
      </div>
      <div class="input-row">
        <label for="randomBars">Bars:</label>
        <input type="number" id="randomBars" value="10" />
      </div>
      <button id="saveRandomMode">Save</button>
    </div>
  </div>

  <!-- Settings Popup -->
  <div id="settingsPopup" class="speed-mode-popup" style="display: none;">
    <div class="popup-content">
      <span id="closeSettingsPopup" class="close-popup">&times;</span>
      <h2>Settings</h2>
      
      <!-- Background Color Section -->
      <div class="color-section">
        <div class="color-section-title">Background Color</div>
        <div class="color-picker-container" id="bgSwatches">
          <div class="color-swatch" style="background-color: #262626;" data-color="#262626" data-type="bg"></div>
          <div class="color-swatch" style="background-color: #1a1a2e;" data-color="#1a1a2e" data-type="bg"></div>
          <div class="color-swatch" style="background-color: #1e3a2a;" data-color="#1e3a2a" data-type="bg"></div>
          <div class="color-swatch" style="background-color: #2d1b2e;" data-color="#2d1b2e" data-type="bg"></div>
          <div class="color-swatch" style="background-color: #000000;" data-color="#000000" data-type="bg"></div>
          <div class="color-swatch" style="background-color: #ffffff;" data-color="#ffffff" data-type="bg"></div>
          
          <!-- Custom Color Input -->
          <div class="custom-color-wrapper" title="Custom Color">
            <span class="custom-icon">+</span>
            <input type="color" id="customBgInput" class="custom-color-input" value="#262626">
          </div>
        </div>
      </div>

      <!-- Text Color Section -->
      <div class="color-section">
        <div class="color-section-title">Text Color</div>
        <div class="color-picker-container" id="textSwatches">
          <div class="color-swatch" style="background-color: #ffffff;" data-color="#ffffff" data-type="text"></div>
          <div class="color-swatch" style="background-color: #e0e0e0;" data-color="#e0e0e0" data-type="text"></div>
          <div class="color-swatch" style="background-color: #a0a0a0;" data-color="#a0a0a0" data-type="text"></div>
          <div class="color-swatch" style="background-color: #29be6f;" data-color="#29be6f" data-type="text"></div>
          <div class="color-swatch" style="background-color: #ff6b6b;" data-color="#ff6b6b" data-type="text"></div>
          <div class="color-swatch" style="background-color: #000000;" data-color="#000000" data-type="text"></div>

          <!-- Custom Color Input -->
          <div class="custom-color-wrapper" title="Custom Color">
            <span class="custom-icon">+</span>
            <input type="color" id="customTextInput" class="custom-color-input" value="#ffffff">
          </div>
        </div>
      </div>

    </div>
  </div>
</body>
</html>